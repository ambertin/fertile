---
title: "Lab3_Regression"
author: "Audrey Bertin"
date: "09/28/17"
output: oilabs::lab_report
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(oilabs)
data(mlb11)
```

* * *

### Exercise 1: 

A scatterplot is good for showing the relationship between two numerical variables.

```{r}
ggplot(mlb11, aes(x=at_bats, y=runs)) + geom_point()

```
The relationship looks somewhat linear though the relationship only looks to be of moderate strength. I would be okay with using at_bats to predict runs (because it's a moderate linear relationship), but another variable probably has a stronger relationship with runs, which would be a more effective predictor. 

```{r}
mlb11 %>%
  summarise (cor(runs, at_bats))
```

### Exercise 2: 

runs and at_bats seem to have a positive linear relationship that is of moderate strength. There are a few outliers (such as one point that's really high on the left side), and there seem to be a lot fewer points on the right, so there aren't as many data points from which to make an accurate best fit line there.


### Exercise 3:

The smallest sum of squares I got was 123,744.3 with the equation runs = -2743.1 + 0.6223(at_bats). The sum I got seems on average lower than most of my neighbors.

### Exercise 4:

```{r}
hr <- lm(runs ~ homeruns, data = mlb11)
hr

```
The equation of the regression line would be: runs =  415.239 + 1.835(homeruns). The slope tells us that for each home run we get, we expect to get 1.835 more runs.

### Exercise 5:

```{r}
qplot(x=at_bats, y=runs, data=mlb11, geom="point") + geom_smooth(method="lm", se=FALSE)

ab <- lm(runs ~ at_bats, data=mlb11)
ab

```
Using the best fit line equation, the manager would expect approx 728 (original number: 728.3166) runs. The actual point at_bats = 5579 has runs = 713, meaning the best fit line gives an overestimate of about 15 runs (728-713).


### Exercise 9:

```{r}

ggplot(mlb11, aes(x=bat_avg, y=runs)) + geom_point() + geom_smooth(method = "lm", se = FALSE)

```

There does seem to be a linear relationship between bat_avg and runs.


### Exercise 10:

```{r}
ba <- lm(runs ~ bat_avg, data=mlb11)
summary(ba)
summary(ab)
```
My model of bat_avg and runs appears to show a stronger relationship than the model of at_bats and runs because my R^2 is larger. The R^2 value for my model is about 0.66, while the R^2 for the original model is about 0.37.


### Exercise 11

It turns out that the model with the highest R^2 value was my chosen model with x = bat_avg. (The second best model was hits with an R^2 of 0.64) The graph is once again reproduced below:

```{r}

ggplot(mlb11, aes(x=bat_avg, y=runs)) + geom_point() + geom_smooth(method = "lm", se = FALSE)

summary(ba)

```

### Exercise 12:

All three new statistics give higher R^2 values (when compared with runs) than any of the old statistics. The best predictor of runs was new_obs with an R^2 of 0.93, whereas the best predictor with old statistics had an R^2 of only 0.66. The model for new_obs and runs is shown below:

```{r}
ggplot(mlb11, aes(x=new_obs, y=runs)) + geom_point() + geom_smooth(method = "lm", se=FALSE)

obs <- lm(runs ~ new_obs, data=mlb11)
summary(obs)

```
It makes sense that obs (on base + slugging) gives a really good predition for runs since it represents the sum of a player's on-base percentage (you need to be on base to get a run) plus their ability to hit the ball hard (key for getting runs because hard balls go far and are more difficult to catch, meaning the more hard hits you do, the more likely you are to score).
